<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telemedicina Rural</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <script src="script.js"></script>
    <div id="syncStatus" class="sync-status" style="background: #28a745;">
        âœ“ Sistema iniciado
    </div>

    <div class="container">
        <div id="demoBanner" class="demo-banner" style="display: none;">
            ğŸ­ MODO DEMO ACTIVADO - Simulando conexiÃ³n Firebase
        </div>

        <div class="header">
            <h1>ğŸ¥ Telemedicina Rural Conectada</h1>
            <p>Sistema de consultas mÃ©dicas remotas para comunidades rurales</p>
        </div>

        <div class="status-bar">
            <span id="connectionStatus" class="status-online">â— Iniciando sistema...</span>
            <span>Paciente: <strong id="patientName">Nuevo Paciente</strong></span>
            <span id="pendingItems">Pendientes: 0</span>
            <div id="statsInfo" class="stats-info">ğŸ“Š Cargando estadÃ­sticas...</div>
        </div>

        <!-- Datos del Paciente -->
        <div class="form-section">
            <h3><span class="icon">ğŸ‘¤</span>InformaciÃ³n del Paciente</h3>
            <div class="form-group">
                <label>Nombre completo:</label>
                <input type="text" id="patientFullName" placeholder="Ingresa el nombre del paciente">
            </div>
            <div class="vital-signs-grid">
                <div class="form-group">
                    <label>Edad:</label>
                    <input type="number" id="age" placeholder="AÃ±os" min="0" max="120">
                </div>
                <div class="form-group">
                    <label>GÃ©nero:</label>
                    <select id="gender">
                        <option value="">Seleccionar</option>
                        <option value="M">Masculino</option>
                        <option value="F">Femenino</option>
                        <option value="O">Otro</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Signos Vitales -->
        <div class="form-section">
            <h3><span class="icon">ğŸ“Š</span>Signos Vitales</h3>
            <div class="vital-signs-grid">
                <div class="form-group">
                    <label>PresiÃ³n Arterial (mmHg):</label>
                    <input type="text" id="bloodPressure" placeholder="120/80" pattern="[0-9]{2,3}/[0-9]{2,3}">
                </div>
                <div class="form-group">
                    <label>Temperatura (Â°C):</label>
                    <input type="number" id="temperature" placeholder="36.5" step="0.1" min="30" max="45">
                </div>
                <div class="form-group">
                    <label>Frecuencia CardÃ­aca (lpm):</label>
                    <input type="number" id="heartRate" placeholder="72" min="30" max="200">
                </div>
                <div class="form-group">
                    <label>SaturaciÃ³n O2 (%):</label>
                    <input type="number" id="oxygenSat" placeholder="98" min="80" max="100">
                </div>
            </div>
        </div>

        <!-- CÃ¡mara y Fotos -->
        <div class="form-section">
            <h3><span class="icon">ğŸ“¸</span>EvaluaciÃ³n FÃ­sica</h3>
            <div class="camera-section">
                <video id="cameraPreview" class="camera-preview" autoplay muted style="display: none;"></video>
                <canvas id="photoCanvas" style="display: none;"></canvas>

                <div>
                    <button class="btn" onclick="startCamera()">ğŸ“· Iniciar CÃ¡mara</button>
                    <button class="btn btn-success" onclick="takePhoto()" id="takePhotoBtn" style="display: none;">âœ¨
                        Tomar Foto</button>
                    <button class="btn btn-danger" onclick="stopCamera()">â¹ï¸ Detener</button>
                </div>

                <div class="form-group">
                    <label>Tipo de evaluaciÃ³n:</label>
                    <select id="photoType">
                        <option value="herida">ğŸ©¹ Herida o lesiÃ³n</option>
                        <option value="erupcion">ğŸ”´ ErupciÃ³n cutÃ¡nea</option>
                        <option value="laboratorio">ğŸ§ª Resultado de laboratorio</option>
                        <option value="radiologia">ğŸ“± Imagen radiolÃ³gica</option>
                        <option value="general">ğŸ‘ï¸ EvaluaciÃ³n general</option>
                    </select>
                </div>
            </div>

            <div id="photoGallery" class="photo-gallery"></div>
        </div>

        <!-- SÃ­ntomas y Observaciones -->
        <div class="form-section">
            <h3><span class="icon">ğŸ“</span>SÃ­ntomas y Observaciones</h3>
            <div class="form-group">
                <label>SÃ­ntomas principales:</label>
                <textarea id="symptoms" rows="3"
                    placeholder="Describe los sÃ­ntomas del paciente (dolor, fiebre, malestar, etc.)..."></textarea>
            </div>
            <div class="form-group">
                <label>Observaciones del promotor de salud:</label>
                <textarea id="observations" rows="3"
                    placeholder="Observaciones adicionales, antecedentes relevantes, medicamentos actuales..."></textarea>
            </div>
            <div class="form-group">
                <label>Nivel de urgencia:</label>
                <select id="urgencyLevel">
                    <option value="baja">ğŸŸ¢ Baja - Consulta rutinaria</option>
                    <option value="media">ğŸŸ¡ Media - Requiere atenciÃ³n</option>
                    <option value="alta">ğŸŸ  Alta - Urgente</option>
                    <option value="critica">ğŸ”´ CrÃ­tica - Emergencia</option>
                </select>
            </div>
        </div>

        <!-- Video Consulta -->
        <div class="form-section">
            <h3><span class="icon">ğŸ¥</span>Consulta por Video</h3>
            <div class="video-section">
                <button class="btn btn-success" onclick="startVideoCall()">ğŸ¥ Iniciar Videollamada</button>
                <button class="btn" onclick="scheduleCall()">ğŸ“… Programar Consulta</button>
                <button class="btn btn-warning" onclick="sendEmergencyAlert()">ğŸš¨ Alerta de Emergencia</button>

                <iframe id="videoFrame" style="display: none;" allow="camera; microphone"></iframe>
            </div>
        </div>

        <!-- Acciones -->
        <div class="form-section">
            <div style="text-align: center;">
                <button class="btn btn-success" onclick="saveConsultation()">ğŸ’¾ Guardar Consulta</button>
                <button class="btn" onclick="syncData()" id="syncBtn">ğŸ”„ Sincronizar Datos</button>
                <button class="btn btn-danger" onclick="clearForm()">ğŸ—‘ï¸ Limpiar Formulario</button>
            </div>

            <!-- Controles de sistema -->
            <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 2px solid #eee;">
                <h4 style="color: #6c757d; margin-bottom: 15px;">ğŸ”§ Controles del Sistema</h4>
                <button class="btn" onclick="toggleDemoMode()" id="demoToggle" style="background: #6f42c1;">ğŸ­ Activar
                    Modo Demo</button>
                <button class="btn" onclick="showSystemStatus()" style="background: #17a2b8;">ğŸ“Š Estado del
                    Sistema</button>
                <button class="btn" onclick="exportData()" style="background: #28a745;">ğŸ“¤ Exportar Datos</button>
            </div>
        </div>

        <div id="pendingSync" style="display: none;" class="pending-sync">
            â³ <strong>Datos guardados localmente</strong><br>
            Se sincronizarÃ¡n automÃ¡ticamente cuando haya conexiÃ³n a Internet
        </div>
    </div>

    <!-- Modal para programar consulta -->
    <div id="scheduleModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>ğŸ“… Programar Consulta MÃ©dica</h3>
            <div class="form-group">
                <label>Fecha de la consulta:</label>
                <input type="date" id="consultationDate">
            </div>
            <div class="form-group">
                <label>Hora de la consulta:</label>
                <input type="time" id="consultationTime">
            </div>
            <div class="form-group">
                <label>Especialista solicitado:</label>
                <select id="specialistType">
                    <option value="general">Medicina General</option>
                    <option value="pediatria">PediatrÃ­a</option>
                    <option value="ginecologia">GinecologÃ­a</option>
                    <option value="dermatologia">DermatologÃ­a</option>
                    <option value="cardiologia">CardiologÃ­a</option>
                    <option value="otro">Otra especialidad</option>
                </select>
            </div>
            <div class="form-group">
                <label>Motivo de la consulta:</label>
                <textarea id="consultationNotes" rows="3"
                    placeholder="Describe brevemente el motivo de la consulta..."></textarea>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="confirmSchedule()">âœ… Confirmar Cita</button>
                <button class="btn btn-danger" onclick="closeScheduleModal()">âŒ Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Scripts Firebase -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.10.1/firebase-app.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.10.1/firebase-firestore.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.10.1/firebase-storage.min.js"></script>


</body>

</html>